
// 26 pozicij, 27 naprav
var position_measurements = [ 
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-78,4.52]},
        {node: "LGTC53", rssi: [-97.0,4.99]},
        {node: "LGTC54", rssi: [-86,3.78]},
        {node: "LGTC55", rssi: [-97,4.39]},
        {node: "LGTC56", rssi: [-93,5.52]},
        {node: "LGTC57", rssi: [-85,4.44]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-87.5,5.25]},
        {node: "LGTC60", rssi: [-99,7.34]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-96,2.09]},
        {node: "LGTC63", rssi: [-100.0,2.26]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-100,3.99]},
        {node: "LGTC67", rssi: [-97.0,3.72]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-86.5,3.22]},
        {node: "LGTC70", rssi: [-83,3.98]},
        {node: "LGTC71", rssi: [-94.0,3.8]},
        {node: "LGTC81", rssi: [-87,5.06]},
        {node: "LGTC82", rssi: [-78,4.8]},
        {node: "LGTC83", rssi: [-93.0,5.2]},
        {node: "LGTC84", rssi: [-90.0,5.01]},
        {node: "LGTC85", rssi: [-95.0,3.08]},
        {node: "LGTC86", rssi: [-96.0,3.25]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-74,4.04]},
        {node: "LGTC53", rssi: [-95,4.72]},
        {node: "LGTC54", rssi: [-88,4.38]},
        {node: "LGTC55", rssi: [-97,4.05]},
        {node: "LGTC56", rssi: [-96.0,3.82]},
        {node: "LGTC57", rssi: [-84.0,5.38]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-90.0,5.68]},
        {node: "LGTC60", rssi: [-98,3.25]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-97,3.3]},
        {node: "LGTC63", rssi: [-99.5,3.07]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-99.5,4.12]},
        {node: "LGTC67", rssi: [-97,3.64]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-87,3.79]},
        {node: "LGTC70", rssi: [-89,4.16]},
        {node: "LGTC71", rssi: [-86.0,4.55]},
        {node: "LGTC81", rssi: [-92.0,4.35]},
        {node: "LGTC82", rssi: [-72.0,3.48]},
        {node: "LGTC83", rssi: [-96,4.43]},
        {node: "LGTC84", rssi: [-93,4.78]},
        {node: "LGTC85", rssi: [-96,6.46]},
        {node: "LGTC86", rssi: [-96.0,5.21]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-75,3.2]},
        {node: "LGTC53", rssi: [-93.0,4.85]},
        {node: "LGTC54", rssi: [-93.0,4.39]},
        {node: "LGTC55", rssi: [-96,5.26]},
        {node: "LGTC56", rssi: [-97,5.43]},
        {node: "LGTC57", rssi: [-84,3.95]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-86,6.43]},
        {node: "LGTC60", rssi: [-98,3.43]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-97.0,3.61]},
        {node: "LGTC63", rssi: [-99.5,3.91]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-100.0,6.36]},
        {node: "LGTC67", rssi: [-95.0,4.27]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-89.0,5.06]},
        {node: "LGTC70", rssi: [-91,4.51]},
        {node: "LGTC71", rssi: [-88,4.26]},
        {node: "LGTC81", rssi: [-96,5.18]},
        {node: "LGTC82", rssi: [-73,3.76]},
        {node: "LGTC83", rssi: [-90,5.1]},
        {node: "LGTC84", rssi: [-89,5.5]},
        {node: "LGTC85", rssi: [-96.0,3.93]},
        {node: "LGTC86", rssi: [-96,4.19]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-74.0,3.37]},
        {node: "LGTC53", rssi: [-91.0,4.97]},
        {node: "LGTC54", rssi: [-91.0,3.82]},
        {node: "LGTC55", rssi: [-94.0,5.23]},
        {node: "LGTC56", rssi: [-94,4.32]},
        {node: "LGTC57", rssi: [-91.0,4.9]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-90,4.72]},
        {node: "LGTC60", rssi: [-103.0,4.79]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-97.0,3.63]},
        {node: "LGTC63", rssi: [-98,2.9]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-97.0,3.44]},
        {node: "LGTC67", rssi: [-97,5.13]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-92.0,4.97]},
        {node: "LGTC70", rssi: [-90.0,4.69]},
        {node: "LGTC71", rssi: [-94,5.68]},
        {node: "LGTC81", rssi: [-89,5.44]},
        {node: "LGTC82", rssi: [-75.0,4.24]},
        {node: "LGTC83", rssi: [-92.0,4.06]},
        {node: "LGTC84", rssi: [-92,3.92]},
        {node: "LGTC85", rssi: [-96,4.16]},
        {node: "LGTC86", rssi: [-96,3.28]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-76,4.59]},
        {node: "LGTC53", rssi: [-90,4.24]},
        {node: "LGTC54", rssi: [-88,3.7]},
        {node: "LGTC55", rssi: [-97.0,3.7]},
        {node: "LGTC56", rssi: [-96,4.98]},
        {node: "LGTC57", rssi: [-89,6.01]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-90.0,5.71]},
        {node: "LGTC60", rssi: [-97.0,2.84]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-94,3.94]},
        {node: "LGTC63", rssi: [-103,2.35]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-97,2.79]},
        {node: "LGTC67", rssi: [-93,3.91]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-90,3.75]},
        {node: "LGTC70", rssi: [-87.0,3.75]},
        {node: "LGTC71", rssi: [-94.0,3.95]},
        {node: "LGTC81", rssi: [-88,4.88]},
        {node: "LGTC82", rssi: [-73.0,4.02]},
        {node: "LGTC83", rssi: [-93,4.31]},
        {node: "LGTC84", rssi: [-89.0,5.49]},
        {node: "LGTC85", rssi: [-97.0,4.35]},
        {node: "LGTC86", rssi: [-95.0,3.46]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-80.0,3.79]},
        {node: "LGTC53", rssi: [-90,5.9]},
        {node: "LGTC54", rssi: [-88,5.74]},
        {node: "LGTC55", rssi: [-97,3.72]},
        {node: "LGTC56", rssi: [-96,4.02]},
        {node: "LGTC57", rssi: [-95,3.9]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-93.5,4.48]},
        {node: "LGTC60", rssi: [-100.5,2.88]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-96,5.41]},
        {node: "LGTC63", rssi: [-100,3.13]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-96.0,4.35]},
        {node: "LGTC67", rssi: [-98.0,6.32]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-92,3.6]},
        {node: "LGTC70", rssi: [-80.0,4.72]},
        {node: "LGTC71", rssi: [-87.0,3.53]},
        {node: "LGTC81", rssi: [-93.5,4.44]},
        {node: "LGTC82", rssi: [-76,3.97]},
        {node: "LGTC83", rssi: [-90,4.73]},
        {node: "LGTC84", rssi: [-85.0,4.41]},
        {node: "LGTC85", rssi: [-95,3.61]},
        {node: "LGTC86", rssi: [-92,3.78]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-77.0,3.2]},
        {node: "LGTC53", rssi: [-92,4.45]},
        {node: "LGTC54", rssi: [-92.0,4.87]},
        {node: "LGTC55", rssi: [-93,4.14]},
        {node: "LGTC56", rssi: [-94,4.19]},
        {node: "LGTC57", rssi: [-90,3.8]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-91.5,4.31]},
        {node: "LGTC60", rssi: [-98,2.41]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-93.0,3.44]},
        {node: "LGTC63", rssi: [-100,3.14]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-96,3.35]},
        {node: "LGTC67", rssi: [0,0]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-93.5,3.2]},
        {node: "LGTC70", rssi: [-83,4.3]},
        {node: "LGTC71", rssi: [-86.0,6.05]},
        {node: "LGTC81", rssi: [-92.0,4.72]},
        {node: "LGTC82", rssi: [-75.0,4.63]},
        {node: "LGTC83", rssi: [-87,6.61]},
        {node: "LGTC84", rssi: [-90,4.2]},
        {node: "LGTC85", rssi: [-94.0,3.71]},
        {node: "LGTC86", rssi: [-93.0,2.88]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-78.0,3.81]},
        {node: "LGTC53", rssi: [-87,5.53]},
        {node: "LGTC54", rssi: [-92.0,5.84]},
        {node: "LGTC55", rssi: [-92.5,4.56]},
        {node: "LGTC56", rssi: [-93.0,4.52]},
        {node: "LGTC57", rssi: [-85.0,3.07]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-90,4.43]},
        {node: "LGTC60", rssi: [-100,1.88]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-94,4.33]},
        {node: "LGTC63", rssi: [-103,4.71]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-97,3.21]},
        {node: "LGTC67", rssi: [0,0]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-92,4.17]},
        {node: "LGTC70", rssi: [-89,5.48]},
        {node: "LGTC71", rssi: [-89.0,3.89]},
        {node: "LGTC81", rssi: [-90.0,4.34]},
        {node: "LGTC82", rssi: [-77.0,3.24]},
        {node: "LGTC83", rssi: [-87,5.63]},
        {node: "LGTC84", rssi: [-87,5.75]},
        {node: "LGTC85", rssi: [-90.0,6.61]},
        {node: "LGTC86", rssi: [-91.0,4.57]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-82.0,4.16]},
        {node: "LGTC53", rssi: [-91,4.38]},
        {node: "LGTC54", rssi: [-92,5.68]},
        {node: "LGTC55", rssi: [-89.0,5.86]},
        {node: "LGTC56", rssi: [-92,3.91]},
        {node: "LGTC57", rssi: [-86,3.45]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-89.0,6.92]},
        {node: "LGTC60", rssi: [-100.0,2.84]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-93.0,5.59]},
        {node: "LGTC63", rssi: [-99,2.67]},
        {node: "LGTC64", rssi: [-103,5.0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-92.0,4.8]},
        {node: "LGTC67", rssi: [0,0]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-91.0,3.69]},
        {node: "LGTC70", rssi: [-83.0,4.12]},
        {node: "LGTC71", rssi: [-90,3.26]},
        {node: "LGTC81", rssi: [-92,5.11]},
        {node: "LGTC82", rssi: [-81,6.04]},
        {node: "LGTC83", rssi: [-84.5,5.61]},
        {node: "LGTC84", rssi: [-87.0,4.85]},
        {node: "LGTC85", rssi: [-89.5,4.47]},
        {node: "LGTC86", rssi: [-93.0,4.92]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-85,4.2]},
        {node: "LGTC53", rssi: [-88.0,5.0]},
        {node: "LGTC54", rssi: [-87.0,4.49]},
        {node: "LGTC55", rssi: [-94.0,4.61]},
        {node: "LGTC56", rssi: [-92,5.61]},
        {node: "LGTC57", rssi: [-89,4.08]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-94,4.18]},
        {node: "LGTC60", rssi: [-98.0,2.63]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-94.0,3.02]},
        {node: "LGTC63", rssi: [-98.0,2.68]},
        {node: "LGTC64", rssi: [-3,3]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-97.0,3.41]},
        {node: "LGTC67", rssi: [0,0]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-93,5.76]},
        {node: "LGTC70", rssi: [-89.0,4.95]},
        {node: "LGTC71", rssi: [-95,3.61]},
        {node: "LGTC81", rssi: [-93,4.8]},
        {node: "LGTC82", rssi: [-87,4.46]},
        {node: "LGTC83", rssi: [-89,4.92]},
        {node: "LGTC84", rssi: [-86,6.81]},
        {node: "LGTC85", rssi: [-91.0,4.74]},
        {node: "LGTC86", rssi: [-88.0,3.77]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-87.0,5.05]},
        {node: "LGTC53", rssi: [-86.0,6.05]},
        {node: "LGTC54", rssi: [-78.0,3.85]},
        {node: "LGTC55", rssi: [-92.0,4.32]},
        {node: "LGTC56", rssi: [-89,4.66]},
        {node: "LGTC57", rssi: [-89,4.53]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-93.0,4.82]},
        {node: "LGTC60", rssi: [-99.0,3.85]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-94,2.98]},
        {node: "LGTC63", rssi: [-96.0,4.36]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-96,4.15]},
        {node: "LGTC67", rssi: [0,0]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-88,5.01]},
        {node: "LGTC70", rssi: [-87,5.05]},
        {node: "LGTC71", rssi: [-96.0,4.49]},
        {node: "LGTC81", rssi: [-92,5.81]},
        {node: "LGTC82", rssi: [-88,5.2]},
        {node: "LGTC83", rssi: [-88,4.85]},
        {node: "LGTC84", rssi: [-82.0,5.27]},
        {node: "LGTC85", rssi: [-89,4.74]},
        {node: "LGTC86", rssi: [-87.0,5.02]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-89,4.55]},
        {node: "LGTC53", rssi: [-86,4.77]},
        {node: "LGTC54", rssi: [-74.0,4.23]},
        {node: "LGTC55", rssi: [-90,5.02]},
        {node: "LGTC56", rssi: [-88,6.09]},
        {node: "LGTC57", rssi: [-96.0,3.68]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-96,4.51]},
        {node: "LGTC60", rssi: [-98.5,2.87]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-93,3.2]},
        {node: "LGTC63", rssi: [-93,5.3]},
        {node: "LGTC64", rssi: [-100,2.22]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-96,3.82]},
        {node: "LGTC67", rssi: [0,0]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-85.0,5.93]},
        {node: "LGTC70", rssi: [-83.0,4.37]},
        {node: "LGTC71", rssi: [-97.0,4.67]},
        {node: "LGTC81", rssi: [-92,5.24]},
        {node: "LGTC82", rssi: [-94,3.85]},
        {node: "LGTC83", rssi: [-88.0,4.73]},
        {node: "LGTC84", rssi: [-76,4.26]},
        {node: "LGTC85", rssi: [-89.0,6.69]},
        {node: "LGTC86", rssi: [-88.0,6.76]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-90.0,5.57]},
        {node: "LGTC53", rssi: [-84,5.52]},
        {node: "LGTC54", rssi: [-80.0,5.35]},
        {node: "LGTC55", rssi: [-92.0,5.72]},
        {node: "LGTC56", rssi: [-90.0,3.87]},
        {node: "LGTC57", rssi: [-93.0,2.94]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-92,4.53]},
        {node: "LGTC60", rssi: [-97.5,2.48]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-93,3.48]},
        {node: "LGTC63", rssi: [-97.0,3.6]},
        {node: "LGTC64", rssi: [-100,2.7]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-95.0,3.73]},
        {node: "LGTC67", rssi: [0,0]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-83.0,6.25]},
        {node: "LGTC70", rssi: [-83.0,4.06]},
        {node: "LGTC71", rssi: [-91.0,3.93]},
        {node: "LGTC81", rssi: [-90,4.81]},
        {node: "LGTC82", rssi: [-94.0,3.51]},
        {node: "LGTC83", rssi: [-90.0,4.68]},
        {node: "LGTC84", rssi: [-75,3.62]},
        {node: "LGTC85", rssi: [-86.0,4.86]},
        {node: "LGTC86", rssi: [-91,4.29]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-94,5.42]},
        {node: "LGTC53", rssi: [-82.5,5.14]},
        {node: "LGTC54", rssi: [-83.0,5.18]},
        {node: "LGTC55", rssi: [-86,5.39]},
        {node: "LGTC56", rssi: [-81,5.08]},
        {node: "LGTC57", rssi: [-96,5.38]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-96.0,3.51]},
        {node: "LGTC60", rssi: [-100,3.32]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-93,3.85]},
        {node: "LGTC63", rssi: [-96.0,3.84]},
        {node: "LGTC64", rssi: [-103,4.32]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-90.0,4.49]},
        {node: "LGTC67", rssi: [-92.0,3.13]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-82.0,2.81]},
        {node: "LGTC70", rssi: [-88.0,4.76]},
        {node: "LGTC71", rssi: [-92.0,3.86]},
        {node: "LGTC81", rssi: [-93,5.2]},
        {node: "LGTC82", rssi: [-93,4.56]},
        {node: "LGTC83", rssi: [-83.0,5.12]},
        {node: "LGTC84", rssi: [-74.0,4.64]},
        {node: "LGTC85", rssi: [-85,3.68]},
        {node: "LGTC86", rssi: [-88,4.9]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-94,4.19]},
        {node: "LGTC53", rssi: [-82,4.05]},
        {node: "LGTC54", rssi: [-80,4.51]},
        {node: "LGTC55", rssi: [-87.0,4.44]},
        {node: "LGTC56", rssi: [-88.0,4.96]},
        {node: "LGTC57", rssi: [-96,3.98]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-96,4.98]},
        {node: "LGTC60", rssi: [-96.0,3.35]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-91,3.16]},
        {node: "LGTC63", rssi: [-94.0,3.76]},
        {node: "LGTC64", rssi: [-101.5,2.92]},
        {node: "LGTC65", rssi: [-3,3]},
        {node: "LGTC66", rssi: [-88.0,4.85]},
        {node: "LGTC67", rssi: [-92.5,4.28]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-83,5.09]},
        {node: "LGTC70", rssi: [-88.0,4.23]},
        {node: "LGTC71", rssi: [-90.0,3.07]},
        {node: "LGTC81", rssi: [-93.0,4.92]},
        {node: "LGTC82", rssi: [-94,4.91]},
        {node: "LGTC83", rssi: [-86.0,4.66]},
        {node: "LGTC84", rssi: [-75.0,2.9]},
        {node: "LGTC85", rssi: [-87.0,3.99]},
        {node: "LGTC86", rssi: [-90.0,5.11]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-92,5.16]},
        {node: "LGTC53", rssi: [-88,5.35]},
        {node: "LGTC54", rssi: [-77,3.31]},
        {node: "LGTC55", rssi: [-90,4.08]},
        {node: "LGTC56", rssi: [-84.0,2.76]},
        {node: "LGTC57", rssi: [-97,3.56]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-97,4.2]},
        {node: "LGTC60", rssi: [-100,2.32]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-94.5,3.05]},
        {node: "LGTC63", rssi: [-97,4.82]},
        {node: "LGTC64", rssi: [0,0]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-96,3.21]},
        {node: "LGTC67", rssi: [-91,3.84]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-82.0,3.23]},
        {node: "LGTC70", rssi: [-82,4.56]},
        {node: "LGTC71", rssi: [-93,4.47]},
        {node: "LGTC81", rssi: [-94.5,4.94]},
        {node: "LGTC82", rssi: [-93,3.57]},
        {node: "LGTC83", rssi: [-88,4.95]},
        {node: "LGTC84", rssi: [-76,3.8]},
        {node: "LGTC85", rssi: [-92.0,4.28]},
        {node: "LGTC86", rssi: [-90,4.63]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-91.0,4.32]},
        {node: "LGTC53", rssi: [-87,5.02]},
        {node: "LGTC54", rssi: [-78.0,4.0]},
        {node: "LGTC55", rssi: [-87.0,5.67]},
        {node: "LGTC56", rssi: [-84.0,3.82]},
        {node: "LGTC57", rssi: [-96.0,3.08]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-94.0,3.51]},
        {node: "LGTC60", rssi: [-97,2.79]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-92.0,4.85]},
        {node: "LGTC63", rssi: [-92.5,5.29]},
        {node: "LGTC64", rssi: [-99,3.13]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-96,3.94]},
        {node: "LGTC67", rssi: [-93,4.9]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-85,3.29]},
        {node: "LGTC70", rssi: [-80.0,4.4]},
        {node: "LGTC71", rssi: [-96.0,3.71]},
        {node: "LGTC81", rssi: [-91.0,5.68]},
        {node: "LGTC82", rssi: [-89.5,4.58]},
        {node: "LGTC83", rssi: [-91.0,4.59]},
        {node: "LGTC84", rssi: [-76.0,3.98]},
        {node: "LGTC85", rssi: [-90.0,5.61]},
        {node: "LGTC86", rssi: [-88.0,5.3]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-89.0,5.95]},
        {node: "LGTC53", rssi: [-88.0,6.08]},
        {node: "LGTC54", rssi: [-77.0,5.51]},
        {node: "LGTC55", rssi: [-86,4.77]},
        {node: "LGTC56", rssi: [-82,5.43]},
        {node: "LGTC57", rssi: [-93,4.66]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-95.5,4.48]},
        {node: "LGTC60", rssi: [-100.0,4.19]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-93,4.15]},
        {node: "LGTC63", rssi: [-93,4.18]},
        {node: "LGTC64", rssi: [-103,3.38]},
        {node: "LGTC65", rssi: [-3,3]},
        {node: "LGTC66", rssi: [-94,6.58]},
        {node: "LGTC67", rssi: [-91,4.81]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-89.0,5.94]},
        {node: "LGTC70", rssi: [-83,6.58]},
        {node: "LGTC71", rssi: [-93.0,3.52]},
        {node: "LGTC81", rssi: [-94,4.45]},
        {node: "LGTC82", rssi: [-90,4.85]},
        {node: "LGTC83", rssi: [-92,4.1]},
        {node: "LGTC84", rssi: [-81,5.2]},
        {node: "LGTC85", rssi: [-91,5.39]},
        {node: "LGTC86", rssi: [-89.0,5.3]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-93.0,3.51]},
        {node: "LGTC53", rssi: [-88,5.46]},
        {node: "LGTC54", rssi: [-79.0,4.67]},
        {node: "LGTC55", rssi: [-89,5.6]},
        {node: "LGTC56", rssi: [-87.0,4.81]},
        {node: "LGTC57", rssi: [-94,3.52]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-95,3.9]},
        {node: "LGTC60", rssi: [-96.5,4.34]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-93,3.53]},
        {node: "LGTC63", rssi: [-94.0,4.41]},
        {node: "LGTC64", rssi: [-103.0,2.22]},
        {node: "LGTC65", rssi: [0,0]},
        {node: "LGTC66", rssi: [-96.0,4.26]},
        {node: "LGTC67", rssi: [-91.5,4.19]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-88,5.45]},
        {node: "LGTC70", rssi: [-92,3.88]},
        {node: "LGTC71", rssi: [-96.0,5.05]},
        {node: "LGTC81", rssi: [-96,4.55]},
        {node: "LGTC82", rssi: [-93.0,4.88]},
        {node: "LGTC83", rssi: [-91.0,3.91]},
        {node: "LGTC84", rssi: [-79,4.49]},
        {node: "LGTC85", rssi: [-90,4.94]},
        {node: "LGTC86", rssi: [-85.0,5.0]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-93.0,3.86]},
        {node: "LGTC53", rssi: [-89.0,4.75]},
        {node: "LGTC54", rssi: [-86,5.57]},
        {node: "LGTC55", rssi: [-91.0,4.87]},
        {node: "LGTC56", rssi: [-83.5,5.96]},
        {node: "LGTC57", rssi: [-94.0,4.6]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-93,3.81]},
        {node: "LGTC60", rssi: [-99,1.73]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-92.0,4.2]},
        {node: "LGTC63", rssi: [-96.0,4.55]},
        {node: "LGTC64", rssi: [-100.0,2.64]},
        {node: "LGTC65", rssi: [-103.0,0.0]},
        {node: "LGTC66", rssi: [-92,4.29]},
        {node: "LGTC67", rssi: [-92.0,5.19]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-86,5.24]},
        {node: "LGTC70", rssi: [-87,5.77]},
        {node: "LGTC71", rssi: [-99,2.82]},
        {node: "LGTC81", rssi: [-93,4.37]},
        {node: "LGTC82", rssi: [-96,3.09]},
        {node: "LGTC83", rssi: [-92.0,4.69]},
        {node: "LGTC84", rssi: [-90.0,4.39]},
        {node: "LGTC85", rssi: [-85,5.22]},
        {node: "LGTC86", rssi: [-84.0,5.32]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-92.5,4.08]},
        {node: "LGTC53", rssi: [-85,5.25]},
        {node: "LGTC54", rssi: [-80.0,4.19]},
        {node: "LGTC55", rssi: [-86,4.49]},
        {node: "LGTC56", rssi: [-86.0,5.18]},
        {node: "LGTC57", rssi: [-93.0,3.99]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-94.0,4.62]},
        {node: "LGTC60", rssi: [-96,2.38]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-89.0,3.68]},
        {node: "LGTC63", rssi: [-93,5.7]},
        {node: "LGTC64", rssi: [-100,4.52]},
        {node: "LGTC65", rssi: [-100,2.87]},
        {node: "LGTC66", rssi: [-90.0,5.39]},
        {node: "LGTC67", rssi: [-96.0,5.2]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-86.0,4.46]},
        {node: "LGTC70", rssi: [-89,5.9]},
        {node: "LGTC71", rssi: [-93,2.86]},
        {node: "LGTC81", rssi: [-93.0,4.19]},
        {node: "LGTC82", rssi: [-97.0,3.33]},
        {node: "LGTC83", rssi: [-86.0,5.51]},
        {node: "LGTC84", rssi: [-90.0,4.23]},
        {node: "LGTC85", rssi: [-82.0,2.75]},
        {node: "LGTC86", rssi: [-88,6.74]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-94.0,4.54]},
        {node: "LGTC53", rssi: [-84,4.03]},
        {node: "LGTC54", rssi: [-81,4.2]},
        {node: "LGTC55", rssi: [-87,5.01]},
        {node: "LGTC56", rssi: [-79.0,3.69]},
        {node: "LGTC57", rssi: [-94.0,3.99]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-92.0,4.0]},
        {node: "LGTC60", rssi: [-98.0,3.05]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-89.0,3.95]},
        {node: "LGTC63", rssi: [-94.0,4.58]},
        {node: "LGTC64", rssi: [-102.5,2.5]},
        {node: "LGTC65", rssi: [-103.0,4.45]},
        {node: "LGTC66", rssi: [-93,4.77]},
        {node: "LGTC67", rssi: [-93,4.22]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-83,3.69]},
        {node: "LGTC70", rssi: [-87,3.34]},
        {node: "LGTC71", rssi: [-93,2.69]},
        {node: "LGTC81", rssi: [-94.0,3.38]},
        {node: "LGTC82", rssi: [-96,4.02]},
        {node: "LGTC83", rssi: [-90,5.5]},
        {node: "LGTC84", rssi: [-84,5.29]},
        {node: "LGTC85", rssi: [-81.0,4.2]},
        {node: "LGTC86", rssi: [-81.0,4.26]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-92.5,3.09]},
        {node: "LGTC53", rssi: [-85,5.45]},
        {node: "LGTC54", rssi: [-81.0,4.85]},
        {node: "LGTC55", rssi: [-90,5.84]},
        {node: "LGTC56", rssi: [-74.0,5.27]},
        {node: "LGTC57", rssi: [-93.0,3.91]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-94.0,3.98]},
        {node: "LGTC60", rssi: [-3,3]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-90,4.74]},
        {node: "LGTC63", rssi: [-92.0,4.66]},
        {node: "LGTC64", rssi: [-103,2.51]},
        {node: "LGTC65", rssi: [-100.0,6.47]},
        {node: "LGTC66", rssi: [-91.0,4.56]},
        {node: "LGTC67", rssi: [-93.0,5.82]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-84,3.51]},
        {node: "LGTC70", rssi: [-87.5,4.82]},
        {node: "LGTC71", rssi: [-96.0,6.37]},
        {node: "LGTC81", rssi: [-95.0,3.75]},
        {node: "LGTC82", rssi: [-99.0,3.69]},
        {node: "LGTC83", rssi: [-89.0,4.25]},
        {node: "LGTC84", rssi: [-87,4.6]},
        {node: "LGTC85", rssi: [-82.0,5.99]},
        {node: "LGTC86", rssi: [-79.0,5.24]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-91.0,4.01]},
        {node: "LGTC53", rssi: [-87.0,5.22]},
        {node: "LGTC54", rssi: [-83.0,4.59]},
        {node: "LGTC55", rssi: [-90,5.57]},
        {node: "LGTC56", rssi: [-76.0,3.89]},
        {node: "LGTC57", rssi: [-96,4.19]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-94,4.23]},
        {node: "LGTC60", rssi: [-97.0,2.82]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-89,4.75]},
        {node: "LGTC63", rssi: [-93,4.91]},
        {node: "LGTC64", rssi: [-100,2.09]},
        {node: "LGTC65", rssi: [-103.0,5.36]},
        {node: "LGTC66", rssi: [-93,4.7]},
        {node: "LGTC67", rssi: [-92,4.88]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-85.0,5.99]},
        {node: "LGTC70", rssi: [-87.0,4.16]},
        {node: "LGTC71", rssi: [-92.0,3.12]},
        {node: "LGTC81", rssi: [-92.0,4.34]},
        {node: "LGTC82", rssi: [-97,2.42]},
        {node: "LGTC83", rssi: [-92,4.32]},
        {node: "LGTC84", rssi: [-92.0,4.78]},
        {node: "LGTC85", rssi: [-87,4.38]},
        {node: "LGTC86", rssi: [-79.0,4.36]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-96.0,4.09]},
        {node: "LGTC53", rssi: [-85.0,3.45]},
        {node: "LGTC54", rssi: [-87.0,4.47]},
        {node: "LGTC55", rssi: [-90,5.29]},
        {node: "LGTC56", rssi: [-77.0,4.72]},
        {node: "LGTC57", rssi: [-97,3.5]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-91,5.02]},
        {node: "LGTC60", rssi: [-97.0,1.55]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-91,5.6]},
        {node: "LGTC63", rssi: [-94,4.59]},
        {node: "LGTC64", rssi: [-106,2.99]},
        {node: "LGTC65", rssi: [-97,4.33]},
        {node: "LGTC66", rssi: [-92,4.78]},
        {node: "LGTC67", rssi: [-93.0,5.03]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-89.0,5.09]},
        {node: "LGTC70", rssi: [-86,4.34]},
        {node: "LGTC71", rssi: [-93,5.14]},
        {node: "LGTC81", rssi: [-95.0,5.27]},
        {node: "LGTC82", rssi: [-100.0,2.92]},
        {node: "LGTC83", rssi: [-88.0,4.48]},
        {node: "LGTC84", rssi: [-90,4.52]},
        {node: "LGTC85", rssi: [-81.0,3.3]},
        {node: "LGTC86", rssi: [-83.0,6.17]},
    ],
    [
        {node: "LGTC51", rssi: [0,0]},
        {node: "LGTC52", rssi: [-93,3.62]},
        {node: "LGTC53", rssi: [-89.0,5.98]},
        {node: "LGTC54", rssi: [-86,3.98]},
        {node: "LGTC55", rssi: [-87,4.89]},
        {node: "LGTC56", rssi: [-75.0,4.65]},
        {node: "LGTC57", rssi: [-97,3.9]},
        {node: "LGTC58", rssi: [0,0]},
        {node: "LGTC59", rssi: [-96.0,4.46]},
        {node: "LGTC60", rssi: [-97.0,3.33]},
        {node: "LGTC61", rssi: [0,0]},
        {node: "LGTC62", rssi: [-89.0,4.8]},
        {node: "LGTC63", rssi: [-95,4.88]},
        {node: "LGTC64", rssi: [-99,2.99]},
        {node: "LGTC65", rssi: [-100.0,5.24]},
        {node: "LGTC66", rssi: [-91.0,5.39]},
        {node: "LGTC67", rssi: [-92.0,5.15]},
        {node: "LGTC68", rssi: [0,0]},
        {node: "LGTC69", rssi: [-86,3.92]},
        {node: "LGTC70", rssi: [-84.0,3.73]},
        {node: "LGTC71", rssi: [-95.0,3.17]},
        {node: "LGTC81", rssi: [-94,4.2]},
        {node: "LGTC82", rssi: [-95.0,4.76]},
        {node: "LGTC83", rssi: [-94.0,3.76]},
        {node: "LGTC84", rssi: [-91.0,4.89]},
        {node: "LGTC85", rssi: [-91.0,4.71]},
        {node: "LGTC86", rssi: [-72,2.96]},
    ],
    ];



var node_names = [
    "LGTC51",
    "LGTC52",
    "LGTC53",
    "LGTC54",
    "LGTC55",
    "LGTC56",
    "LGTC57",
    "LGTC58",
    "LGTC59",
    "LGTC60",
    "LGTC61",
    "LGTC62",
    "LGTC63",
    "LGTC64",
    "LGTC65",
    "LGTC66",
    "LGTC67",
    "LGTC68",
    "LGTC69",
    "LGTC70",
    "LGTC71",
    
    "LGTC81",
    "LGTC82",
    "LGTC83",
    "LGTC84",
    "LGTC85",
    "LGTC86"
]

// Zacnes pri zacetku smetnjaka in po 3 ploscice naprej (2 preskocis)
var position_coordiantes =[
    [1 , -220, -403],   // smetnjak zacetek
    [2 , -220, -394],
    [3 , -220, -385],   // node 51
    [4 , -220, -376],
    [5 , -220, -367],
    [6 , -220, -358],
    [7 , -220, -349],
    [8 , -220, -340],
    [9 , -220, -331],
    [10, -220, -322],
    [11, -220, -313],
    [12, -220, -304],
    [13, -220, -295],   // node 53
    [14, -220, -286],
    [15, -220, -277],
    [16, -220, -268],
    [17, -220, -259],
    [18, -220, -250],
    [19, -220, -241],
    [20, -220, -232],
    [21, -220, -223],
    [22, -220, -214],
    [23, -220, -205],
    [24, -220, -196],   // node 55
    [25, -220, -187],
    [26, -220, -178],   // smetnjak sredina
];

var enabled_devices = [
    0,
    1,
    1,
    1,
    1,
    1,
    1,
    0,
    1,
    1,
    0,
    1,
    1,
    1,
    1,
    1,
    1,
    0,
    1,
    1,
    1,

    1,
    1,
    1,
    1,
    1,
    1
];


var node_locations = [
    [-235,265], // 1
    [-165,265], // 2
    [-235,353], // 3
    [-165,353], // 4
    [-235,441], // 5
    [-165,441], // 6
    [-135,175], // 7
    //[-175,190], 
    [-195,175], // 9
    //[-235,190], 
    [-255,173], // 11
    //[-292,264], 
    [-327,288], // 13
    //[-310,330], 
    [-333,360], // 15
    [-337,408], // 16
    //[-333,433], 
    [-355,478], // 18
    [-435,472], // 19
    [-455,525], // 20
    [-313,538], // 21
    [-203,548], // 22
    [-95 ,530], // 23
    [-95 ,440], // 24
    [-93 ,350], // 25
    [-43 ,198], // 26
    //[-140,490]
];
/**
 * Math
 */
export default class ble_localization {

    constructor() {
        this.P_Tx_dBm = 7.0;
        this.alpha = 3.8;
    }

    WLS_localization(x, y, weights, dist) {
        var z = new Array(x.length).fill(1);
        var w = math.diag(weights);
        var A = [];
        var AT = [];
        var tmp, B;

        A.push(math.multiply(-2.0, x));
        A.push(math.multiply(-2.0, y));
        A.push(z);

        A = math.transpose(math.matrix(A));
        AT = math.transpose(A);

        tmp = math.multiply(AT,w);
        tmp = math.multiply(tmp,A);
        tmp = math.inv(tmp);
        tmp = math.multiply(tmp,AT);
        tmp = math.multiply(tmp, w);

        B = math.multiply(-1, math.add(math.square(x), math.square(y)));
        B = math.add(B, math.square(dist));

        tmp = math.multiply(tmp, B);
        x = tmp._data[0];
        y = tmp._data[1];
        return [x,y,0];
    }

    RSSI_to_distance(rssi){
        var distances = [];
        var d = 0;
        for (let index = 0; index < rssi.length; index++) {
            d = (this.P_Tx_dBm - rssi[index] - 40.05)/(this.alpha*10.0);
            d = math.pow(10.0, d);
            distances.push(d);
        }
        return distances;
    }

    weights_to_locations(weights){
        var x = new Array(weights.length).fill(1);
        var y = new Array(weights.length).fill(1);
        for (let index = 0; index < weights.length; index++) {
            if(weights[index]){
                x[index] = node_locations[index][0];
                y[index] = node_locations[index][1];
            }
        }
        return [x,y];
    }


}

const median = arr => {
    let middle = Math.floor(arr.length / 2);
      arr = [...arr].sort((a, b) => a - b);
    return arr.length % 2 !== 0 ? arr[middle] : (arr[middle - 1] + arr[middle]) / 2;
  };

/**
 * Device list with their measurement queues & list of active devices.
 * 
 * queue = [
 *  {device:"LGTC51", data:[1,2,3]},
 *  {device:"LGTC52", data:[1,2,3]},
 *  {device:"LGTC53", data:[]},
 *  .
 *  .
 *  .
 *  {device:"LGTC71", data:[1,2,3]},
 * ]
 * 
 * node_states  = [1, 1, 0, ... , 1]
 */
export class rssi_queue {

    constructor() {
        this.num_of_dev = node_names.length;
        this.queue = [];
        this.node_states = [];
        this.node_active = [];
        this.clean();
    }

    // Cleans the queue and list of active devices.
    // Must be called before/after the experiment start/end!
    clean() {
        this.node_states = new Array(this.num_of_dev).fill(0);
        this.node_active = new Array(this.num_of_dev).fill(0);
        this.queue = new Array(this.num_of_dev).fill(0);
        for(let i=0; i<this.num_of_dev; i++) {
            let q = {device:node_names[i], data:[]};
            this.queue[i] = q;
        }
    }

    // Add measurements to the queue and mark the device as active
    putMeasurement(dev_name, rssi) {
        let index = this.queue.findIndex(m => m.device === dev_name);
        if(index != -1){
            this.queue[index]["data"].push(rssi);
            this.node_active[index] = 1;
        }
        else {
            console.warn("Device with name" + dev_name + " is not suited for this exp.")
        }
    }

    // Get measurements from one device
    getOneMeasurement(dev_name) {
        let index = this.queue.findIndex(m => m.device === dev_name);
        return this.queue[index]["data"];
    }

    // Get all & averaged measurements from the queue
    getAllMeasurements(del = true) {
        let m = new Array(this.num_of_dev).fill(0);
        this.node_states = new Array(this.num_of_dev).fill(0);

        // First check if there is enough measurements
        let count = 0;
        for(let i=0; i<this.num_of_dev; i++) {
            let itm = this.queue[i]["data"].length;
            if (itm != 0){
                count += 1;
            }
        }
        if(count <= 3){
            return;
        }

        // Cycle through device queue
        for(let i=0; i<this.num_of_dev; i++) {
            let avg = 0;
            let items = this.queue[i]["data"].length;
            // Cycle through items (if there are any)
            if (items != 0){
                
                /*
                for(let j=0; j<items; j++) {
                    avg += this.queue[i]["data"][j];
                }
                avg /= items;
                m[i] = avg;
                */
               let medi = median(this.queue[i]["data"]);
               m[i] = medi;

                // Delete old measurements
                if (del == true) this.queue[i]["data"] = [];
                this.node_states[i] = 1;
            }
            else{
                m[i] = 0;
            }
        }
        return m; 
    }

    getActiveDevices() {
        return this.node_active;
    }

    getActiveMeasurements() {
        return this.node_states;
    }

    // Debug ... TODO: delete 
    printQueue(){
        console.log(this.queue);
    }
}





export class ble_fingerprint {

    constructor() {
        this.num_rx_nodes = 27;
        this.num_positions = 26;

        this.weight_rssi_threshold = -77;

        // Minimalna deviacija pri fingerprintih
        this.min_dev = 1.55;

        // Queue for las 5 locations with its weight
        this.q_len = 3;
        this.location_q = [];

        // For LPF
        this.old_pos = 0;
        this.lpf = 0.7;

        // Tku največji error ki se pojavi je tm okuli 10 :D
        this.MISSED_ERROR = 70;
    }

    getLocation (rssi){

        //cycle through position measurements and find matching index
        var possible_loc = new Array(this.num_positions).fill(0);
        var match = 0;
        var count = 0;
        var weight = 0;

        var err = 0;

        console.log(rssi);

        // Calculate weight for incoming measurements
        for(let i=0; i<rssi.length; i++){
            if (rssi[i] != 0){
                weight += 1;
                // better measurements get higher weight)
                if (rssi[i] > this.weight_rssi_threshold){
                    weight += 10;
                    console.log(rssi[i]);
                }
            }
        }


/*
        // Go through all positions (0~10)
        for(let POS=0; POS<this.num_positions; POS++){

            //console.log("POS: " + POS);

            // Go through RX nodes (0~20)
            for(let NODE=0; NODE<this.num_rx_nodes; NODE++){

                //console.log("NODE: " + NODE);

                // If incoming measurement has any value 
                if(rssi[NODE] != 0){
                    //let min = position_measurements[POS][NODE]["rssi"][0];
                    //let max = position_measurements[POS][NODE]["rssi"][1];

                    let med = position_measurements[POS][NODE]["rssi"][0];
                    let dev = position_measurements[POS][NODE]["rssi"][1];
                    
                    // If fingerprints on that node exists
                    if(enabled_devices[NODE]){
                        count += 1;
                        
                        if(med == 0 && dev == 0){
                            err += this.MISSED_ERROR;
                            //console.log("Missed --------")
                        }
                        else{
                            let razlika = Math.abs((med - rssi[NODE]));
                            let e;

                            if(razlika > dev){
                                e = 1;
                            }
                            else{
                                e = razlika/dev;
                            }
                            //let e = Math.abs((med - rssi[NODE])/dev)
                            //console.log("MEd "+ med +" msmnt " + rssi[NODE] + " devi " + dev + " = error: " + e); 
                            err += e
                        }
                        // Compare the incoming value with fingerprints
                        //if(rssi[NODE] >= min && rssi[NODE] <= max){
                        //    match += 1;
                        //}
                    }
                }
                else{
                    let med = position_measurements[POS][NODE]["rssi"][0];

                    if(med){
                        console.log("------------------")
                        err += this.MISSED_ERROR;
                    }
                }
            }

*/

        // Go through all positions (0~10)
        for(let POS=0; POS<this.num_positions; POS++){

            //console.log("POS: " + POS);

            // Go through RX nodes (0~20)
            for(let NODE=0; NODE<this.num_rx_nodes; NODE++){


                if(enabled_devices[NODE]){
                    // Prejeta meritev
                    if(rssi[NODE] != 0){
                        let med = position_measurements[POS][NODE]["rssi"][0];
                        let dev = position_measurements[POS][NODE]["rssi"][1];

                        // Ce fingerprint obstaja
                        if(med){
                            let razlika = Math.abs((med - rssi[NODE]));
                            let e;
                            let normirana_dev = this.min_dev / dev;
                            e = razlika/normirana_dev;
                            //console.log("MEd "+ med +" msmnt " + rssi[NODE] + " devi " + dev + " = error: " + e); 
                            err += e;
                            count += 1;
                        }
                        else{
                            // Nebi smeu dobit meritve na tej lokaciji
                            err += this.MISSED_ERROR;
                            count += 1;
                        }
                    }
                    // Meritve nismo prejeli pa bi jo mogli - za to so uteži
                    else{}
                }
                // Ce nimamo fingerprintov od naprave
                else{
                    // Pa smo meritev vseeno prejeli
                    if(rssi[NODE] != 0){
                        count += 1;
                    }
                    else{
                        //console.log("Ne naredi nč");
                    }
                }
            }

            let accuracy = err / count; 
            possible_loc[POS] = accuracy;
            count = 0;
            err = 0;
            
            //console.log("Possition " + POS + " : " + accuracy);
        }


        //console.log("Location acuracy:")
        //console.log(possible_loc);
        //console.log(position_measurements[index]);
        
        // Find max probability of a location
        // IF there is more than 1 maximum in possible locations, take the one with highest neighbors
        let min_error = Math.min.apply(Math, possible_loc);
        //console.log("Max accuracy: " + max_accuracy);

        /*var izbrana ;
        let mozne = [];
        for(let i=0; i<possible_loc.length; i++){
            if(possible_loc[i] == min_error){
                if(i==0){
                    izbrana = possible_loc[i+1];
                }
                else if(i==possible_loc.length-1){
                    izbrana = possible_loc[i-1]
                }
                else{
                    izbrana = (possible_loc[i-1] + possible_loc[i+1]) /2;
                }
                //console.log("pozicija " + i + " szi verjetnostjo " + izbrana);
                mozne.push([i, izbrana]);
            }
        }
        console.log("Promissing locations: ");
        console.log(mozne);
        let len = mozne.length;
        let max_neighbour = 0;
        let index = 0;
        while(len--){
            if(mozne[len][1] > max_neighbour){
                max_neighbour = mozne[len][1];
                index = mozne[len][0];
            }
        }*/

        let index = possible_loc.indexOf(min_error);
        console.log("--- Chosen location: " + index + " with weight: " + weight);

        
        

        // ------- Calculate weighted average of locations ---------
        // add position with corresponding weight to end of Q
        this.location_q.push([index,weight]);
        
        // Remove old position from the Q
        if(this.location_q.length > this.q_len){
            this.location_q.shift()
        }
        
        // Weighted sum
        let sum = this.location_q[0][0] * this.location_q[0][1];
        let sum_w = this.location_q[0][1];

        for(let i=1; i<this.location_q.length; i++){
            sum += this.location_q[i][0] * this.location_q[i][1]
            sum_w += this.location_q[i][1];
        }

        let weighted_index = sum/sum_w;

        //for(let j=0; j<this.location_q.length; j++){
        //    console.log("Q_loc: " + this.location_q[j][0] + " W: " + this.location_q[j][1]);
        //}


        //weighted_index = Math.round(weighted_index);
        //console.log("Weighted index: " + weighted_index);

        //return position_coordiantes[weighted_index];
        



        // ------------------ LP filter --------------------

        let lp_index = (this.old_pos * this.lpf) + (weighted_index * (1-this.lpf));
      
        lp_index = Math.round(lp_index);
        //console.log("LP index: " + lp_index);

        this.old_pos = lp_index;

        return position_coordiantes[lp_index];


    }
}



/*
export class ble_fingerprint {

    constructor() {
        //this.num_rx_nodes = 27;
        //this.num_positions = 26;

        this.num_rx_nodes = 21;
        this.num_positions = 21;

        this.weight_rssi_threshold = -79;

        // Queue for las 5 locations with its weight
        this.q_len = 10;
        this.location_q = [];

        // For LPF
        this.old_pos = 0;
    }

    getLocation (rssi){

        //cycle through position measurements and find matching index
        var possible_loc = new Array(this.num_positions).fill(0);
        var match = 0;
        var count = 0;
        var weight = 0;

        console.log(rssi);

        // Calculate weight for incoming measurements
        for(let i=0; i<rssi.length; i++){
            if (rssi[i] != 0){
                weight += 1;
                // better measurements get higher weight)
                if (rssi[i] > this.weight_rssi_threshold){
                    weight +=1;
                    console.log(rssi[i]);
                }
            }
        }

        // Go through all positions (0~10)
        for(let POS=0; POS<this.num_positions; POS++){

            //console.log("POS: " + POS);

            // Go through RX nodes (0~20)
            for(let NODE=0; NODE<this.num_rx_nodes; NODE++){

                //console.log("NODE: " + NODE);

                // If incoming measurement has any value 
                if(rssi[NODE] != 0){
                    let min = position_measurements[POS][NODE]["rssi"][0];
                    let max = position_measurements[POS][NODE]["rssi"][1];
                    
                    // If fingerprints on that node exists
                    if(min != 0 && max != 0){
                        count += 1;
                        // Compare the incoming value with fingerprints
                        if(rssi[NODE] >= min && rssi[NODE] <= max){
                            match += 1;
                        }
                    }
                }
            }

            let accuracy = match / count; 
            possible_loc[POS] = accuracy;
            count = 0;
            match = 0;
            
            //console.log("Possition " + POS + " : " + accuracy);
        }
        console.log("Location possibilities:")
        console.log(possible_loc);
        //console.log(position_measurements[index]);
        
        // Find max probability of a location
        // IF there is more than 1 maximum in possible locations, take the one with highest neighbors
        let max_accuracy = Math.max.apply(Math, possible_loc);
        //console.log("Max accuracy: " + max_accuracy);

        var izbrana ;
        let mozne = [];
        for(let i=0; i<possible_loc.length; i++){
            if(possible_loc[i] == max_accuracy){
                if(i==0){
                    izbrana = possible_loc[i+1];
                }
                else if(i==possible_loc.length-1){
                    izbrana = possible_loc[i-1]
                }
                else{
                    izbrana = (possible_loc[i-1] + possible_loc[i+1]) /2;
                }
                //console.log("pozicija " + i + " szi verjetnostjo " + izbrana);
                mozne.push([i, izbrana]);
            }
        }
        console.log("Promissing locations: ");
        console.log(mozne);
        let len = mozne.length;
        let max_neighbour = 0;
        let index = 0;
        while(len--){
            if(mozne[len][1] > max_neighbour){
                max_neighbour = mozne[len][1];
                index = mozne[len][0];
            }
        }

        //let index = possible_loc.indexOf(Math.max.apply(Math, possible_loc));
        console.log("--- Chosen location: " + index + " with weight: " + weight);
        

        // ------- Calculate weighted average of locations ---------
        // add position with corresponding weight to end of Q
        this.location_q.push([index,weight]);
        
        // Remove old position from the Q
        if(this.location_q.length > this.q_len){
            this.location_q.shift()
        }
        
        // Weighted sum
        let sum = this.location_q[0][0] * this.location_q[0][1];
        let sum_w = this.location_q[0][1];

        for(let i=1; i<this.location_q.length; i++){
            sum += this.location_q[i][0] * this.location_q[i][1]
            sum_w += this.location_q[i][1];
        }

        let weighted_index = sum/sum_w;

        //for(let j=0; j<this.location_q.length; j++){
        //    console.log("Q_loc: " + this.location_q[j][0] + " W: " + this.location_q[j][1]);
        //}

        console.log("Weighted index: " + weighted_index);
        



        // ------------------ LP filter --------------------

        let lp_index = (this.old_pos * 0.8) + (weighted_index * 0.2);

        
        lp_index = Math.round(lp_index);
        console.log("LP index: " + lp_index);

        this.old_pos = lp_index;

        return position_coordiantes[lp_index];
    }
}

*/